{"customFields":{},"titlePrefix":"SYS COMP","name":"Ransomware","pap":2,"metrics":{},"description":"Ransomware has been found on a system.","severity":2,"tlp":2,"status":"Ok","tasks":[{"description":"_Objective:  Gather events from various sources (log files, error messages,etc.) in order to determine if an incident has occurred.  If an incident has occurred, determine scope and parties involved.  This is also the phase where incident responders should be documenting everything that they are doing, as stated earlier these documents should be able to answer the Who, What, Where, Why, and How questions._\n\n### Host Based Identification\n- Perform backup using KAPE's Ransomware collection module\n   - Collect memory image\n   - Collect list of running processes\n   - Collect list of network connections\n   - Collect VSS copies\n- Look for unusual executable binaries in user's profiles (All %USERSPROFILE% or %APPDATA% or %SYSTEMDRIVE%)\n- Look for extensions or notes related to ransomware\n- Identify unusual processes\n- Identify email attachment patterns (Consult PhishER)\n- Identify unusual network or web browsing activities...Tor/Bitcoin payment sites (Consult MISP/IPS)\n\n### Network Based Identification\n- Look for connection patterns to exploit kits (Consult MISP/IPS)\n- Look for connection patterns to ransomware C&C (Consult MISP/IPS)\n- Identify unusual network or web browsing activities...Tor/Bitcoin payment sites (Consult MISP/IPS)\n\n**Identify Ransomware**\n* https://id-ransomware.malwarehunterteam.com/\n* https://www.nomoreransom.org/crypto-sheriff.php?lang=en\n\n**Upload Observables**\n* Any suspicious files collected from steps below.\n\n**Run Analyzerz**\n* Against any suspicious files collect from steps below.","title":"Identification","order":0,"group":"STAGE 1"},{"description":"_Objective: Limit the damage and prevent any further damage from happening. Short term containment followed by long term solution._\n\n* Instruct IT support to remove system(s) from the network\n* If computer cannot be isolated, disconnect shared drives\n   * NET USE x:\\\\unc\\path\\ /DELETE\n* Block traffic to identified ransomware C&C\n\n```\nBefore wiping and re-imaging, take a forensic image of affected system(s) in the event the incident resulted from a criminal act.\n```","title":"Containment","order":1,"group":"STAGE 2"},{"description":"_Objective: Ensure all proper steps were taken to remove malicious and other illicit content and all systems have been restored to a clean stated._\n\n* Restore system from image and recover from good backup.\n* Scan all connected devices/cloud storage for similar threats.\n* Improve defenses\n   * User awareness\n   * Disable SMB","title":"Eradication","order":2,"group":"STAGE 3"},{"description":"_Objective:  Bring affected systems back into the production environment, carefully._\n\n1. Ensure no malicious binaries are present on system.\n2. Ensure network traffic is back to normal.\n3. Restore user's documents from backups.\n4. Update SIEM rules to detect future infections.","title":"Recovery","order":3,"group":"STAGE 4"},{"description":"_Objective: Complete any documentation that was not done during the incident, as well as any additional documentation that may be beneficial in future incidents._\n\n**Outline**\n* When was the problem first detected and by whom\n* The scope of the incident\n* How was it contained and eradicated\n* Work performed during recovery\n* Areas where SIRT team was effective\n* Areas that need improved\n\n**PhishER**\n\n* If applicable, create YARA rules to identify future threats of this ransomware.\n\n**MISP**\n\n* Publish data to MISP.\n\n**ServiceNow**\n\n* Close ticket if applicable.","title":"Lessons Learned","order":4,"group":"STAGE 5"}]}