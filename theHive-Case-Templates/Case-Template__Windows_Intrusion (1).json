{"customFields":{},"titlePrefix":"SYS COMP","pap":2,"tasks":[{"description":"_Objective:  Gather events from various sources (log files, error messages,etc.) in order to determine if an incident has occurred.  If an incident has occurred, determine scope and parties involved.  This is also the phase where incident responders should be documenting everything that they are doing, as stated earlier these documents should be able to answer the Who, What, Where, Why, and How questions._\n\n**Collect data using KAPE and appropriate modules.**\n\nUnusual Processes and Services\n\n```Look for unusual/unexpected processes, and focus on processes with User Name “SYSTEM” or “Administrator” (or users in the Administrators' group).```\n\nUnusual Files and RegKeys\n\n* Check file space usage to look for sudden major decreases in free space.\nLook for strange programs in startup registry keys in both HKLM & HKCU:\n\n_Software\\Microsoft\\Windows\\CurrentVersion\\Run_\n\n_Software\\Microsoft\\Windows\\CurrentVersion\\Runonce_\n\n_Software\\Microsoft\\Windows\\CurrentVersion\\RunonceEx_\n\nUnusual Network Usage\n* View and verify file shares\n* List open SMB sessions with this machine\n* List SMB sessions this machine has open with other systems\n* Look at NetBIOS over TCP/IP activity\n* Look for unusual listening TCP and UDP ports\n* Check host firewall configuration\n\nUnusual Scheduled Tasks\n* Look for unusual scheduled tasks, especially those that run as a user in the Admin group, as SYSTEM, or with a blank user name.\n* Check auto start items for unexpected entries, remembering to check user auto start directories and registry keys.\n\nUnusual Accounts\n* Look for new, unexpected, accounts in the Admin group.\n\nUnusual Log Entries such as:\n* \"Event log service was stopped.\"\n* \"Windows File Protection is not active on this system.\"\n* \"The protected System file [file name] was not restored to its original, valid version because the Windows File Protection...\"\n* \"The MS Telnet Service has started successfully.\"\n* Look for large numbers of failed logon attempts or locked out accounts.\n* Unusual accounts \n* Unusual files \n* Unusual registry entries \n* Unusual processes and services \n* Check user's autostart folders \n* Look for unusual/unexpected network services installed and started \n* Unusual network activity \n* Unusual automated tasks \n* Unusual log entries \n* Perform rootkit/malware check \n\n**Upload Obervables**\n* Unusual files \n* IP Addresses \n* URLs  \n\n**Run Analyzers**","title":"Identification","order":0,"group":"STAGE 1"},{"description":"_Objective: Limit the damage and prevent any further damage from happening. Short term containment followed by long term solution._\n\n* Isolate system(s) on network\n* Create forensic image of system(s)\n* Remove accounts/backdoors left by attackers on affected systems\n* Find all files used by the attacker and understand their function\n* Check all files recently accessed\n* Inspect network shares to see if malware has spread\n* Identify how attacker infected system, keeping in mind it could be from physical access (insider threat)\n* Apply patches/fixes when applicable in cases where attack vector used known vulnerability","title":"Containment","order":1,"group":"STAGE 2"},{"description":"_Objective: Ensure all proper steps were taken to remove malicious and other illicit content and all systems have been restored to a clean stated._\n\nExample: using original disk image to restore system then install patches and disable unused services to harden system. Scan affected system to ensure no malware remains.\n\n* Temporarily remove all access to the accounts involved in the incident. \n* Remove all malicious files installed by the attacker. ","title":"Eradication","order":2,"group":"STAGE 3"},{"description":"_Objective: Ensure all proper steps were taken to remove malicious and other illicit content and all systems have been restored to a clean stated._\n\n* Restore system from known good image. \n* Change all system's accounts passwords. \n* Restore all files. ","title":"Recovery","order":3,"group":"STAGE 4"},{"description":"_Objective: Complete any documentation that was not done during the incident, as well as any additional documentation that may be beneficial in future incidents._\n\n**MISP**\n* Publish data to MISP. \n\n**ServiceNow**\n* Close ticket.","title":"Lessons Learned","order":4,"group":"STAGE 5"}],"metrics":{},"name":"Windows Intrusion","severity":2,"tlp":2,"description":"A  Windows system has been compromised.","status":"Ok"}